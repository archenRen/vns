#!/usr/bin/env ruby

require './session'
require './vns'
require './person'
require 'parallel'

VNS_AMOUNT = 4

people = [
  'Sample person 1',
  'Sample person 2',
  'Sample person 3',
  'Sample person 4',
  'Sample person 5',
  'Sample person 6',
  'Sample person 7',
  'Sample person 8',
  'Sample person 9',
  'Sample person 10',
  'Sample person 11',
  'Sample person 12',
  'Sample person 13',
  'Sample person 14',
  'Sample person 15',
  'Sample person 16',
  'Sample person 17',
  'Sample person 18',
  'Sample person 19',
  'Sample person 20',
  'Sample person 21',
  'Sample person 22',
  'Sample person 23',
  'Sample person 24',
  'Sample person 25',
  'Sample person 26',
  'Sample person 27',
  'Sample person 28',
  'Sample person 29',
  'Sample person 30',
  'Sample person 31',
  'Sample person 32',
  'Sample person 33',
  'Sample person 34',
  'Sample person 35',
  'Sample person 36',
  'Sample person 37',
  'Sample person 38',
  'Sample person 39',
  'Sample person 40',
  'Sample person 41',
  'Sample person 42',
  'Sample person 43',
  'Sample person 44',
  'Sample person 45',
  'Sample person 46',
  'Sample person 47',
  'Sample person 48',
  'Sample person 49',
  'Sample person 50',
  'Sample person 51',
  'Sample person 52',
  'Sample person 53',
  'Sample person 54',
  'Sample person 55',
  'Sample person 56',
  'Sample person 57',
  'Sample person 58',
  'Sample person 59',
  'Sample person 60',
  'Sample person 61',
  'Sample person 62',
  'Sample person 63',
  'Sample person 64',
  'Sample person 65',
  'Sample person 66',
  'Sample person 67',
  'Sample person 68',
  'Sample person 69',
  'Sample person 70',
  'Sample person 71',
  'Sample person 72',
  'Sample person 73',
  'Sample person 74',
  'Sample person 75',
  'Sample person 76',
  'Sample person 77',
  'Sample person 78',
  'Sample person 79',
  'Sample person 80',
  'Sample person 81',
  'Sample person 82',
  'Sample person 83',
  'Sample person 84',
  'Sample person 85',
  'Sample person 86',
  'Sample person 87',
  'Sample person 88',
  'Sample person 89',
  'Sample person 90',
  'Sample person 91',
  'Sample person 92',
  'Sample person 93',
  'Sample person 94',
  'Sample person 95',
  'Sample person 96',
  'Sample person 97',
  'Sample person 98',
  'Sample person 99',
  'Sample person 100',
  'Sample person 101',
  'Sample person 102',
  'Sample person 103',
  'Sample person 104',
  'Sample person 105',
  'Sample person 106',
  'Sample person 107',
  'Sample person 108',
  'Sample person 109',
  'Sample person 110',
  'Sample person 111',
  'Sample person 112',
  'Sample person 113',
  'Sample person 114',
  'Sample person 115',
  'Sample person 116',
  'Sample person 117',
  'Sample person 118',
  'Sample person 119',
  'Sample person 120',
  'Sample person 121',
  'Sample person 122',
  'Sample person 123',
  'Sample person 124',
  'Sample person 125',
  'Sample person 126',
  'Sample person 127',
  'Sample person 128',
  'Sample person 129',
  'Sample person 130',
  'Sample person 131',
  'Sample person 132',
  'Sample person 133',
  'Sample person 134',
  'Sample person 135',
  'Sample person 136',
  'Sample person 137',
  'Sample person 138',
  'Sample person 139',
  'Sample person 140',
  'Sample person 141',
  'Sample person 142',
  'Sample person 143',
  'Sample person 144',
  'Sample person 145',
  'Sample person 146',
  'Sample person 147',
  'Sample person 148'
].each_with_index.map do |name, i|
  Person.new i, name
end
sessions = [
  'Session 1',
  'Session 2',
  'Session 3',
  'Session 4',
  'Session 5',
  'Session 6'
].each_with_index.map { |name, i| Session.new i, name }

OPTIONS = (1..sessions.count).to_a

preferences = [
  %w[2 6 5 4 1 3],
  %w[2 5 6 4 1 3],
  %w[6 4 5 1 3 2],
  %w[1 3 6 5 2 4],
  %w[1 3 6 5 2 4],
  %w[4 1 6 3 2 5],
  %w[6 4 2 5 3 1],
  %w[4 5 6 2 1 3],
  %w[6 4 3 5 2 1],
  %w[6 3 1 2 4 5],
  %w[2 3 6 4 1 5],
  %w[4 5 6 2 3 1],
  %w[6 4 1 5 2 3],
  %w[6 2 3 5 4 1],
  %w[3 4 2 5 1 6],
  %w[6 5 2 3 1 4],
  %w[6 4 3 2 1 5],
  %w[6 2 3 4 1 5],
  %w[3 1 5 4 2 6],
  %w[5 4 3 2 6 1],
  %w[4 6 5 2 1 3],
  %w[6 3 1 5 2 4],
  %w[6 2 1 5 4 3],
  %w[2 4 1 5 3 6],
  %w[6 2 1 5 4 3],
  %w[4 1 6 2 5 3],
  %w[6 4 1 3 2 5],
  %w[3 6 1 4 2 5],
  %w[6 1 4 3 2 5],
  %w[1 4 5 6 2 3],
  %w[1 5 4 6 2 3],
  %w[5 2 4 3 1 6],
  %w[5 3 2 4 6 1],
  %w[4 3 5 2 1 6],
  %w[5 3 1 6 4 2],
  %w[3 1 2 5 4 6],
  %w[1 3 4 5 2 6],
  %w[4 2 1 5 3 6],
  %w[4 2 1 6 3 5],
  %w[5 2 1 3 4 6],
  %w[3 1 6 4 2 5],
  %w[5 4 3 2 1 6],
  %w[6 5 4 2 1 3],
  %w[3 6 5 4 1 2],
  %w[2 3 4 6 1 5],
  %w[5 4 1 2 6 3],
  %w[5 1 6 4 3 2],
  %w[1 2 4 5 3 6],
  %w[3 2 6 5 1 4],
  %w[2 1 6 4 5 3],
  %w[5 1 6 2 3 4],
  %w[1 2 6 4 3 5],
  %w[3 1 6 2 4 5],
  %w[6 2 3 4 1 5],
  %w[6 2 5 4 3 1],
  %w[6 2 3 5 1 4],
  %w[6 2 5 1 3 4],
  %w[4 5 2 3 1 6],
  %w[1 6 5 3 2 4],
  %w[3 1 2 4 5 6],
  %w[4 2 1 3 5 6],
  %w[6 2 3 1 4 5],
  %w[4 3 2 5 1 6],
  %w[5 4 3 6 2 1],
  %w[3 4 1 6 5 2],
  %w[3 1 6 4 2 5],
  %w[1 3 6 4 2 5],
  %w[3 6 5 2 4 1],
  %w[2 6 4 5 3 1],
  %w[4 2 1 3 5 6],
  %w[1 2 6 5 3 4],
  %w[6 4 5 3 1 2],
  %w[6 2 1 4 5 3],
  %w[4 3 5 6 1 2],
  %w[6 3 1 5 4 2],
  %w[6 5 3 4 1 2],
  %w[1 2 3 6 4 5],
  %w[6 3 1 4 5 2],
  %w[6 5 3 4 2 1],
  %w[6 3 1 4 5 2],
  %w[6 4 1 3 5 2],
  %w[1 2 3 4 5 6],
  %w[5 3 2 1 6 4],
  %w[5 4 1 3 6 2],
  %w[6 5 1 4 3 2],
  %w[4 5 1 3 6 2],
  %w[6 5 2 3 4 1],
  %w[4 2 6 5 3 1],
  %w[3 1 4 6 2 5],
  %w[6 3 4 2 5 1],
  %w[6 2 4 5 1 3],
  %w[5 3 2 6 1 4],
  %w[4 2 6 1 5 3],
  %w[4 5 1 3 6 2],
  %w[3 1 5 4 2 6],
  %w[5 2 3 1 4 6],
  %w[5 4 1 2 3 6],
  %w[1 6 3 5 4 2],
  %w[4 3 1 5 6 2],
  %w[6 2 4 1 5 3],
  %w[3 1 4 6 5 2],
  %w[2 1 3 4 6 5],
  %w[1 5 3 4 6 2],
  %w[4 2 5 1 3 6],
  %w[1 3 5 6 2 4],
  %w[4 5 6 1 3 2],
  %w[6 1 2 4 3 5],
  %w[2 3 4 1 5 6],
  %w[1 2 3 4 6 5],
  %w[4 1 3 5 6 2],
  %w[5 4 3 6 1 2],
  %w[6 4 1 3 5 2],
  %w[6 3 1 5 2 4],
  %w[3 1 2 4 6 5],
  %w[2 3 4 5 6 1],
  %w[4 1 2 5 6 3],
  %w[2 4 6 1 3 5],
  %w[2 5 3 6 4 1],
  %w[3 2 6 4 5 1],
  %w[6 5 2 4 3 1],
  %w[3 4 5 2 6 1],
  %w[4 5 6 2 1 3],
  %w[6 1 5 2 4 3],
  %w[3 5 2 4 6 1],
  %w[6 1 3 4 2 5],
  %w[6 2 5 3 4 1],
  %w[4 5 1 2 6 3],
  %w[3 2 6 5 4 1],
  %w[3 2 6 5 1 4],
  %w[6 2 1 4 5 3],
  %w[6 3 1 4 5 2],
  %w[6 3 1 4 2 5],
  %w[4 1 2 3 5 6],
  %w[1 4 2 6 5 3],
  %w[6 4 1 3 5 2],
  %w[1 2 3 6 5 4],
  %w[1 3 4 5 6 2],
  %w[2 3 6 4 5 1],
  %w[1 4 3 5 6 2],
  %w[6 5 1 4 3 2],
  %w[2 5 1 3 6 4],
  %w[4 6 5 3 1 2],
  %w[6 5 1 4 2 3],
  %w[6 4 3 2 1 5],
  %w[5 6 4 1 3 2],
  %w[4 2 3 5 1 6],
  %w[6 5 4 1 3 2],
  %w[6 4 3 2 5 1]
].map { |a| a.map(&:to_i) }

puts people.map(&:to_s).join("\n")
puts
puts sessions.map(&:to_s).join("\n")
puts

vns = VNS.new(people, sessions, preferences)
vns.run
puts "Result: #{vns.target_function}"

raise 'Suspicious result' if vns.target_function > 180
